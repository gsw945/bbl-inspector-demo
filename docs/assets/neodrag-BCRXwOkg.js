var we=Object.defineProperty;var be=(e,n,a)=>n in e?we(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;var Z=(e,n,a)=>be(e,typeof n!="symbol"?n+"":n,a);var ee={dragStart:!0},te={delay:0,distance:3};function ve(e,n={}){let a,c,{bounds:u,axis:y="both",gpuAcceleration:h=!0,legacyTranslate:ae=!1,transform:k,applyUserSelectHack:L=!0,disabled:ie=!1,ignoreMultitouch:j=!1,recomputeBounds:x=ee,grid:z,threshold:_=te,position:p,cancel:B,handle:R,defaultClass:$="neodrag",defaultClassDragging:I="neodrag-dragging",defaultClassDragged:D="neodrag-dragged",defaultPosition:ge={x:0,y:0},onDragStart:he,onDrag:pe,onDragEnd:me}=n,N=!1,E=!1,se=0,S=!1,X=!1,w=0,b=0,A=0,C=0,O=0,U=0,{x:Y,y:q}=p?{x:(p==null?void 0:p.x)??0,y:(p==null?void 0:p.y)??0}:ge;J(Y,q);let f,v,M,W,F,le="",ye=!!p;x={...ee,...x},_={...te,..._??{}};let H=new Set;function de(t){N&&!E&&X&&S&&F&&(E=!0,function(r){K("neodrag:start",he,r)}(t),m.add(I),L&&(le=G.userSelect,G.userSelect="none"))}const G=document.body.style,m=e.classList;function J(t=w,r=b){if(!k){if(ae){let s=`${+t}px, ${+r}px`;return T(e,"transform",h?`translate3d(${s}, 0)`:`translate(${s})`)}return T(e,"translate",`${+t}px ${+r}px`)}const i=k({offsetX:t,offsetY:r,rootNode:e});re(i)&&T(e,"transform",i)}function K(t,r,i){const s=function(l){return{offsetX:w,offsetY:b,rootNode:e,currentNode:F,event:l}}(i);e.dispatchEvent(new CustomEvent(t,{detail:s})),r==null||r(s)}const P=addEventListener,Q=new AbortController,V={signal:Q.signal,capture:!1};function ce(){let t=e.offsetWidth/v.width;return isNaN(t)&&(t=1),t}return T(e,"touch-action","none"),P("pointerdown",t=>{if(ie||t.button===2)return;if(H.add(t.pointerId),j&&H.size>1)return t.preventDefault();if(x.dragStart&&(f=oe(u,e)),re(R)&&re(B)&&R===B)throw new Error("`handle` selector can't be same as `cancel` selector");if(m.add($),M=function(o,d){if(!o)return[d];if(ne(o))return[o];if(Array.isArray(o))return o;const g=d.querySelectorAll(o);if(g===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return Array.from(g.values())}(R,e),W=function(o,d){if(!o)return[];if(ne(o))return[o];if(Array.isArray(o))return o;const g=d.querySelectorAll(o);if(g===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return Array.from(g.values())}(B,e),a=/(both|x)/.test(y),c=/(both|y)/.test(y),fe(W,M))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");const r=t.composedPath()[0];if(!M.some(o=>{var d;return o.contains(r)||((d=o.shadowRoot)==null?void 0:d.contains(r))})||fe(W,[r]))return;F=M.length===1?e:M.find(o=>o.contains(r)),N=!0,se=Date.now(),_.delay||(S=!0),v=e.getBoundingClientRect();const{clientX:i,clientY:s}=t,l=ce();a&&(A=i-Y/l),c&&(C=s-q/l),f&&(O=i-v.left,U=s-v.top)},V),P("pointermove",t=>{if(!N||j&&H.size>1)return;if(!E){if(S||Date.now()-se>=_.delay&&(S=!0,de(t)),!X){const l=t.clientX-A,o=t.clientY-C;Math.sqrt(l**2+o**2)>=_.distance&&(X=!0,de(t))}if(!E)return}x.drag&&(f=oe(u,e)),t.preventDefault(),v=e.getBoundingClientRect();let r=t.clientX,i=t.clientY;const s=ce();if(f){const l={left:f.left+O,top:f.top+U,right:f.right+O-v.width,bottom:f.bottom+U-v.height};r=ue(r,l.left,l.right),i=ue(i,l.top,l.bottom)}if(Array.isArray(z)){let[l,o]=z;if(isNaN(+l)||l<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+o)||o<0)throw new Error("2nd argument of `grid` must be a valid positive number");let d=r-A,g=i-C;[d,g]=xe([l/s,o/s],d,g),r=A+d,i=C+g}a&&(w=Math.round((r-A)*s)),c&&(b=Math.round((i-C)*s)),Y=w,q=b,K("neodrag",pe,t),J()},V),P("pointerup",t=>{H.delete(t.pointerId),N&&(E&&(P("click",r=>r.stopPropagation(),{once:!0,signal:Q.signal,capture:!0}),x.dragEnd&&(f=oe(u,e)),m.remove(I),m.add(D),L&&(G.userSelect=le),K("neodrag:end",me,t),a&&(A=w),c&&(C=b)),N=!1,E=!1,S=!1,X=!1)},V),{destroy:()=>Q.abort(),update:t=>{var i,s;y=t.axis||"both",ie=t.disabled??!1,j=t.ignoreMultitouch??!1,R=t.handle,u=t.bounds,x=t.recomputeBounds??ee,B=t.cancel,L=t.applyUserSelectHack??!0,z=t.grid,h=t.gpuAcceleration??!0,ae=t.legacyTranslate??!0,k=t.transform,_={...te,...t.threshold??{}};const r=m.contains(D);m.remove($,D),$=t.defaultClass??"neodrag",I=t.defaultClassDragging??"neodrag-dragging",D=t.defaultClassDragged??"neodrag-dragged",m.add($),r&&m.add(D),ye&&(Y=w=((i=t.position)==null?void 0:i.x)??w,q=b=((s=t.position)==null?void 0:s.y)??b,J())}}}var ue=(e,n,a)=>Math.min(Math.max(e,n),a),re=e=>typeof e=="string",xe=([e,n],a,c)=>{const u=(y,h)=>h===0?0:Math.ceil(y/h)*h;return[u(a,e),u(c,n)]},fe=(e,n)=>e.some(a=>n.some(c=>a.contains(c)));function oe(e,n){if(e===void 0)return;if(ne(e))return e.getBoundingClientRect();if(typeof e=="object"){const{top:c=0,left:u=0,right:y=0,bottom:h=0}=e;return{top:c,right:window.innerWidth-y,bottom:window.innerHeight-h,left:u}}if(e==="parent")return n.parentNode.getBoundingClientRect();const a=document.querySelector(e);if(a===null)throw new Error("The selector provided for bound doesn't exists in the document.");return a.getBoundingClientRect()}var T=(e,n,a)=>e.style.setProperty(n,a),ne=e=>e instanceof HTMLElement,Ee=class{constructor(e,n={}){Z(this,"_drag_instance");Z(this,"_options",{});this.node=e,this._drag_instance=ve(e,this._options=n)}updateOptions(e){this._drag_instance.update(Object.assign(this._options,e))}set options(e){this._drag_instance.update(this._options=e)}get options(){return this._options}destroy(){this._drag_instance.destroy()}};export{Ee as c};
