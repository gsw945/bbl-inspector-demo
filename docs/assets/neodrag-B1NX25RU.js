var t=Object.defineProperty,e=(e,n,r)=>((e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r)(e,"symbol"!=typeof n?n+"":n,r),n={dragStart:!0},r={delay:0,distance:3};var o=(t,e,n)=>Math.min(Math.max(t,e),n),i=t=>"string"==typeof t,a=([t,e],n,r)=>{const o=(t,e)=>0===e?0:Math.ceil(t/e)*e;return[o(n,t),o(r,e)]},s=(t,e)=>t.some((t=>e.some((e=>t.contains(e)))));function l(t,e){if(void 0===t)return;if(c(t))return t.getBoundingClientRect();if("object"==typeof t){const{top:e=0,left:n=0,right:r=0,bottom:o=0}=t;return{top:e,right:window.innerWidth-r,bottom:window.innerHeight-o,left:n}}if("parent"===t)return e.parentNode.getBoundingClientRect();const n=document.querySelector(t);if(null===n)throw new Error("The selector provided for bound doesn't exists in the document.");return n.getBoundingClientRect()}var d=(t,e,n)=>t.style.setProperty(e,n),c=t=>t instanceof HTMLElement,u=class{constructor(t,u={}){e(this,"_drag_instance"),e(this,"_options",{}),this.node=t,this._drag_instance=function(t,e={}){let u,f,{bounds:g,axis:h="both",gpuAcceleration:p=!0,legacyTranslate:m=!1,transform:y,applyUserSelectHack:b=!0,disabled:w=!1,ignoreMultitouch:v=!1,recomputeBounds:x=n,grid:_,threshold:E=r,position:S,cancel:A,handle:C,defaultClass:D="neodrag",defaultClassDragging:N="neodrag-dragging",defaultClassDragged:M="neodrag-dragged",defaultPosition:B={x:0,y:0},onDragStart:R,onDrag:$,onDragEnd:P}=e,X=!1,Y=!1,q=0,H=!1,T=!1,j=0,k=0,L=0,O=0,z=0,I=0,{x:U,y:W}=S?{x:(null==S?void 0:S.x)??0,y:(null==S?void 0:S.y)??0}:B;ot(U,W);let F,G,J,K,Q,V="",Z=!!S;x={...n,...x},E={...r,...E??{}};let tt=new Set;function et(t){X&&!Y&&T&&H&&Q&&(Y=!0,it("neodrag:start",R,t),rt.add(N),b&&(V=nt.userSelect,nt.userSelect="none"))}const nt=document.body.style,rt=t.classList;function ot(e=j,n=k){if(!y){if(m){let r=`${+e}px, ${+n}px`;return d(t,"transform",p?`translate3d(${r}, 0)`:`translate(${r})`)}return d(t,"translate",`${+e}px ${+n}px`)}const r=y({offsetX:e,offsetY:n,rootNode:t});i(r)&&d(t,"transform",r)}function it(e,n,r){const o=function(e){return{offsetX:j,offsetY:k,rootNode:t,currentNode:Q,event:e}}(r);t.dispatchEvent(new CustomEvent(e,{detail:o})),null==n||n(o)}const at=addEventListener,st=new AbortController,lt={signal:st.signal,capture:!1};function dt(){let e=t.offsetWidth/G.width;return isNaN(e)&&(e=1),e}return d(t,"touch-action","none"),at("pointerdown",(e=>{if(w)return;if(2===e.button)return;if(tt.add(e.pointerId),v&&tt.size>1)return e.preventDefault();if(x.dragStart&&(F=l(g,t)),i(C)&&i(A)&&C===A)throw new Error("`handle` selector can't be same as `cancel` selector");if(rt.add(D),J=function(t,e){if(!t)return[e];if(c(t))return[t];if(Array.isArray(t))return t;const n=e.querySelectorAll(t);if(null===n)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return Array.from(n.values())}(C,t),K=function(t,e){if(!t)return[];if(c(t))return[t];if(Array.isArray(t))return t;const n=e.querySelectorAll(t);if(null===n)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return Array.from(n.values())}(A,t),u=/(both|x)/.test(h),f=/(both|y)/.test(h),s(K,J))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");const n=e.composedPath()[0];if(!J.some((t=>{var e;return t.contains(n)||(null==(e=t.shadowRoot)?void 0:e.contains(n))}))||s(K,[n]))return;Q=1===J.length?t:J.find((t=>t.contains(n))),X=!0,q=Date.now(),E.delay||(H=!0),G=t.getBoundingClientRect();const{clientX:r,clientY:o}=e,a=dt();u&&(L=r-U/a),f&&(O=o-W/a),F&&(z=r-G.left,I=o-G.top)}),lt),at("pointermove",(e=>{if(!X||v&&tt.size>1)return;if(!Y){if(H||Date.now()-q>=E.delay&&(H=!0,et(e)),!T){const t=e.clientX-L,n=e.clientY-O;Math.sqrt(t**2+n**2)>=E.distance&&(T=!0,et(e))}if(!Y)return}x.drag&&(F=l(g,t)),e.preventDefault(),G=t.getBoundingClientRect();let n=e.clientX,r=e.clientY;const i=dt();if(F){const t={left:F.left+z,top:F.top+I,right:F.right+z-G.width,bottom:F.bottom+I-G.height};n=o(n,t.left,t.right),r=o(r,t.top,t.bottom)}if(Array.isArray(_)){let[t,e]=_;if(isNaN(+t)||t<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+e)||e<0)throw new Error("2nd argument of `grid` must be a valid positive number");let o=n-L,s=r-O;[o,s]=a([t/i,e/i],o,s),n=L+o,r=O+s}u&&(j=Math.round((n-L)*i)),f&&(k=Math.round((r-O)*i)),U=j,W=k,it("neodrag",$,e),ot()}),lt),at("pointerup",(e=>{tt.delete(e.pointerId),X&&(Y&&(at("click",(t=>t.stopPropagation()),{once:!0,signal:st.signal,capture:!0}),x.dragEnd&&(F=l(g,t)),rt.remove(N),rt.add(M),b&&(nt.userSelect=V),it("neodrag:end",P,e),u&&(L=j),f&&(O=k)),X=!1,Y=!1,H=!1,T=!1)}),lt),{destroy:()=>st.abort(),update:t=>{var e,o;h=t.axis||"both",w=t.disabled??!1,v=t.ignoreMultitouch??!1,C=t.handle,g=t.bounds,x=t.recomputeBounds??n,A=t.cancel,b=t.applyUserSelectHack??!0,_=t.grid,p=t.gpuAcceleration??!0,m=t.legacyTranslate??!0,y=t.transform,E={...r,...t.threshold??{}};const i=rt.contains(M);rt.remove(D,M),D=t.defaultClass??"neodrag",N=t.defaultClassDragging??"neodrag-dragging",M=t.defaultClassDragged??"neodrag-dragged",rt.add(D),i&&rt.add(M),Z&&(U=j=(null==(e=t.position)?void 0:e.x)??j,W=k=(null==(o=t.position)?void 0:o.y)??k,ot())}}}(t,this._options=u)}updateOptions(t){this._drag_instance.update(Object.assign(this._options,t))}set options(t){this._drag_instance.update(this._options=t)}get options(){return this._options}destroy(){this._drag_instance.destroy()}};export{u as c};
